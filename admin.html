<html>
<head>
  <title>Admin</title>

  <!-- Libraries -->
  <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" rel="stylesheet">
  <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>

  <!-- StackMob Dependencies -->
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://static.stackmob.com/js/stackmob-js-0.8.0-bundled-min.js"></script>

  <!-- Site Dependencies -->
  <script type="text/javascript" src="site.js"></script>
  <link rel="stylesheet" href="site.css">

  <!-- Page Code -->
  <script type="text/javascript">
  /* <![CDATA[ */
  $(document).ready(function(){

    locations.query(qAll, {
      success: function(col){
       col.each(function(model){
        /* Add location for new user */
        $("#locationsList").append(
          $('<option></option>').val(model.get('location_id')).html(model.get('name'))
        );
        /* Add locations list for new coffee */
        $("#locationsListForCoffee").append(
          $('<option></option>').val(model.get('location_id')).html(model.get('name'))
        );
       })
     },
     error: function(){ console.log("bad locations query"); }
   });

  coffees.query(qAll, {
      success: function(col){
       col.each(function(model){
        /* Add coffees list for new location */
        $("#coffeesListForLocation").append(
          $('<option></option>').val(model.get('coffee_id')).html(model.get('name'))
        );
       })
     },
     error: function(){ console.log("bad coffee query"); }
   });

    $('#newUser').click(function(){
    	var newUser = new StackMob.User({
        username : $('#username').val(),
        password : $('#password').val(),
        location : $('#locationsList').val()
      });
    	console.log(newUser);
    	newUser.create({

    		success: function(model){
    			$("#status").html('Successfully created user ' + model.get('username') + ' who works at ' + $('#locationsList option:selected').text() + '.<br /><br />');
    		},
    		error: function(){ console.log("bad"); }
    	});
    });

    $('#newLocation').click(function(){
      var newLocation = new Loc({
        name : $('#locationName').val(),
        address : $('#locationAddress').val(),
        coffees : $('#coffeesListForLocation').val()
      });
      console.log(newLocation);
      newLocation.create({

        success: function(model){
          $("#status").html('Successfully created Location ' + model.get('name') + ' at ' + model.get('address') + '.<br /><br />');
        },
        error: function(){ console.log("bad"); }
      });
    });

    $('#newCoffee').click(function(){
      var newCoffee = new Coffee({
        name : $('#coffeeName').val(),
        origin : $('#coffeeOrigin').val(),
        locations : $('#locationsListForCoffee').val()
      });
      console.log(newCoffee);
      newCoffee.create({

        success: function(model){
          $("#status").html('Successfully created Coffee ' + model.get('name') + ' from ' + model.get('origin') + '.<br /><br />');
        },
        error: function(){ console.log("bad"); }
      });
    });
  });

/* ]]> */
</script>

</head>
<body>

  
  <div class="container">
    <div class="row-fluid">

      <div class="span12">
        <div id="status" class="alert"></div>
      </div>

      <div class="span4">
        <h2>Add Coffee:</h2>
        <label>Name:</label> <input id="coffeeName" type="text"></input>
        <label>Origin:</label> <input id="coffeeOrigin" type="text"></input>
        <label>Add To Locations:</label>
        <select size='10' id="locationsListForCoffee" multiple></select><br />
        <input id="newCoffee" class="btn btn-primary" type="button" value="Submit"></input>
      </div>

      <div class="span4">
        <h2>Add Location:</h2>
        <label>Name:</label> <input id="locationName" type="text"></input>
        <label>Address:</label> <input id="locationAddress" type="text"></input>
        <label>Add Coffees for this Location:</label>
        <select size='10' id="coffeesListForLocation" multiple></select><br />
        <input id="newLocation" class="btn btn-primary" type="button" value="Submit"></input>
      </div>

      <div class="span4">
        <h2>Add User:</h2>
        <label>Username:</label> <input id="username" type="text"></input>
        <label>Password:</label> <input id="password" type="password"></input>
        <label>Works At:</label>
        <select id="locationsList"></select><br />
        <input id="newUser" class="btn btn-primary" type="button" value="Submit"></input>
      </div>

    </div>
  </div>
</body>
</html>
